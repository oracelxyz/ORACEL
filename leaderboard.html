<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>ORACEL â€“ Leaderboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<script src="https://cdn.tailwindcss.com"></script>

<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500&display=swap" rel="stylesheet">

<style>
body { font-family: 'Inter', sans-serif; }
h1,h2,h3 { font-family: 'Space Grotesk', sans-serif; }
</style>
</head>

<body class="text-white overflow-x-hidden">

<!-- ðŸŒŒ BG -->
<div class="fixed inset-0 -z-10">
  <div class="absolute inset-0 bg-gradient-to-br from-[#040817] via-[#0A1440] to-[#020617]"></div>
  <div class="absolute inset-0 opacity-[0.25] bg-[url('https://grainy-gradients.vercel.app/noise.svg')]"></div>
</div>

<div class="flex min-h-screen">

<!-- SIDEBAR -->
<aside class="w-64 bg-black/40 backdrop-blur-xl border-r border-blue-400/20 hidden md:flex flex-col justify-between">
  <div>
    <div class="p-6 flex items-center gap-3">
      <img src="logo-oracel.png" class="w-9 h-9 rounded-lg">
      <span class="text-lg font-semibold tracking-widest text-blue-400">ORACEL</span>
    </div>

    <nav class="px-4 space-y-1 text-sm">
      <a href="index.html" class="flex px-4 py-3 rounded-xl hover:bg-blue-500/10">Overview</a>
      <a href="earn.html" class="flex px-4 py-3 rounded-xl hover:bg-blue-500/10">Earn</a>
      <a href="create-mission.html" class="flex px-4 py-3 rounded-xl hover:bg-blue-500/10">Create Mission</a>
      <a href="badge.html" class="flex px-4 py-3 rounded-xl hover:bg-blue-500/10">Badge</a>
      <a class="flex px-4 py-3 rounded-xl bg-blue-500/10 text-blue-400">Leaderboard</a>
      <a class="flex px-4 py-3 rounded-xl opacity-50">Claim (Soon)</a>
      <a href="wallet.html" class="flex px-4 py-3 rounded-xl hover:bg-blue-500/10">Wallet</a>
      <a href="profile.html" class="flex px-4 py-3 rounded-xl hover:bg-blue-500/10">Profile</a>
      <a href="raffle.html" class="flex px-4 py-3 rounded-xl hover:bg-blue-500/10">Raffle</a>
    </nav>
  </div>

  <div class="p-4 border-t border-blue-400/10">
    <button id="logoutBtn"
      class="w-full py-2 rounded-xl bg-red-500/10 text-red-400 hover:bg-red-500/20">
      Logout
    </button>
  </div>
</aside>

<!-- MAIN -->
<main class="flex-1 p-6 space-y-10">

<header class="flex justify-between items-center">
  <h1 class="text-2xl font-semibold tracking-wide">Leaderboard</h1>
  <span class="text-xs tracking-widest text-blue-300/70 uppercase">
    Ranked by OCE Point
  </span>
</header>

<!-- TOP 3 -->
<section id="top3"
 class="max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6"></section>

<!-- FULL LIST -->
<section class="max-w-5xl mx-auto bg-black/40 backdrop-blur-xl
 rounded-3xl border border-blue-400/20 overflow-hidden">

<div class="grid grid-cols-3 px-6 py-4 text-xs uppercase tracking-widest text-gray-400 border-b border-white/10">
  <span>Rank</span>
  <span>User</span>
  <span class="text-right">OCE Point</span>
</div>

<div id="rankList"></div>

</section>

</main>
</div>

<!-- ðŸ”¥ FIREBASE -->
<script type="module">
import { auth, db } from "./firebase.js"
import {
  collection, query, orderBy, getDocs
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"
import {
  onAuthStateChanged, signOut
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"

onAuthStateChanged(auth, user => {
  if (!user) location.href = "login.html"
})

logoutBtn.onclick = async () => {
  await signOut(auth)
  location.href = "login.html"
}

const top3 = document.getElementById("top3")
const rankList = document.getElementById("rankList")

const q = query(collection(db,"users"), orderBy("point","desc"))
const snap = await getDocs(q)

let rank = 1

snap.forEach(doc => {
  const d = doc.data()
  const username = d.x || "anonymous"
  const avatar = d.avatar || "avatar/01.png"
  const point = d.point || 0

  if (rank <= 3) {
    top3.innerHTML += `
    <div class="bg-black/40 backdrop-blur-xl rounded-3xl p-6 border
      ${rank==1?'border-yellow-400 shadow-[0_0_50px_rgba(250,204,21,.35)]':''}
      ${rank==2?'border-gray-300/30':''}
      ${rank==3?'border-orange-400/30':''}
      text-center">
      <div class="text-xs mb-2">#${rank}</div>
      <img src="${avatar}" class="w-16 h-16 mx-auto rounded-full mb-3">
      <h3 class="font-semibold">${username}</h3>
      <p class="text-lg font-bold text-blue-400">${point.toLocaleString()}</p>
      <p class="text-xs text-gray-400">OCE POINT</p>
    </div>`
  } else {
    rankList.innerHTML += `
    <div class="grid grid-cols-3 px-6 py-4 border-b border-white/5 hover:bg-blue-500/5">
      <span>#${rank}</span>
      <span>${username}</span>
      <span class="text-right text-blue-400">${point.toLocaleString()}</span>
    </div>`
  }
  rank++
})
</script>

</body>
</html>